@import "tailwindcss";

@theme {
  --font-sans: 'Nunito', sans-serif;
  --font-serif: 'Merriweather', serif;

  --color-primary-50: #f0f9ff;
  --color-primary-100: #e0f2fe;
  --color-primary-200: #bae6fd;
  --color-primary-300: #7dd3fc;
  --color-primary-400: #38bdf8;
  --color-primary-500: #0ea5e9;
  --color-primary-600: #0284c7;
  --color-primary-700: #0369a1;
  --color-primary-800: #075985;
  --color-primary-900: #0c4a6e;

  --color-background: #f9fafb;
  --color-foreground: #1f2937;
  --color-card: #ffffff;
  --color-card-foreground: #1f2937;
  --color-muted: #f3f4f6;
  --color-muted-foreground: #6b7280;
  --color-border: #e5e7eb;
  --color-destructive: #ef4444;
  --color-success: #22c55e;
  --color-warning: #f59e0b;
}

@layer base {
  .dark {
    --color-background: #0f172a;
    --color-foreground: #f1f5f9;
    --color-card: #1e293b;
    --color-card-foreground: #f1f5f9;
    --color-muted: #334155;
    --color-muted-foreground: #94a3b8;
    --color-border: #334155;
  }

  body {
    @apply bg-background text-foreground font-sans min-h-screen antialiased;
    -webkit-tap-highlight-color: transparent;
  }

  *:focus-visible {
    @apply outline-2 outline-offset-2 outline-primary-500;
  }
}

/* Page enter animation */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-fade-in-up {
  animation: fadeInUp 0.4s ease-out both;
}

/* Staggered list animation */
@keyframes slideIn {
  from { opacity: 0; transform: translateX(-12px); }
  to { opacity: 1; transform: translateX(0); }
}
.animate-slide-in {
  animation: slideIn 0.3s ease-out both;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ─── Flashcard 3D flip ─── */
.flashcard-container {
  perspective: 1200px;
}
.flashcard-inner {
  position: relative;
  width: 100%;
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  transform-style: preserve-3d;
}
.flashcard-inner.flipped {
  transform: rotateY(180deg);
}
.flashcard-front,
.flashcard-back {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  border-radius: 1rem;
}
.flashcard-back {
  transform: rotateY(180deg);
}

/* Swipe feedback */
.swipe-container {
  touch-action: pan-y;
  user-select: none;
}
.swipe-container.swiping-left {
  transform: translateX(-20px) rotate(-2deg);
  opacity: 0.8;
}
.swipe-container.swiping-right {
  transform: translateX(20px) rotate(2deg);
  opacity: 0.8;
}

/* ─── Premium Flashcard ─── */
.flashcard-premium {
  position: relative;
  padding: 3px;
  border-radius: 1.25rem;
  background: conic-gradient(from 180deg at 50% 50%, #38bdf8, #818cf8, #c084fc, #f472b6, #fb923c, #38bdf8);
  background-size: 200% 200%;
  animation: gradientSpin 6s linear infinite;
}
.flashcard-premium-inner {
  background: var(--color-card);
  border-radius: calc(1.25rem - 3px);
  width: 100%;
  height: 100%;
}
@keyframes gradientSpin {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
.dark .flashcard-premium {
  background: conic-gradient(from 180deg at 50% 50%, #0ea5e9, #6366f1, #a855f7, #ec4899, #f97316, #0ea5e9);
}

/* Premium card sections */
.flashcard-section {
  border-left: 3px solid var(--section-color, var(--color-primary-400));
  padding: 10px 14px;
  border-radius: 0 10px 10px 0;
  background: var(--color-muted);
  transition: transform 0.2s ease;
}
.flashcard-section:hover {
  transform: translateX(2px);
}

/* Progress bar */
.flashcard-progress-track {
  height: 4px;
  border-radius: 2px;
  background: var(--color-border);
  overflow: hidden;
}
.flashcard-progress-fill {
  height: 100%;
  border-radius: 2px;
  background: linear-gradient(90deg, var(--color-primary-400), var(--color-primary-600));
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Horizontal word list */
.flashcard-wordlist {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding: 8px 4px;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: thin;
}
.flashcard-wordlist::-webkit-scrollbar { height: 4px; }
.flashcard-wordlist::-webkit-scrollbar-thumb { @apply bg-primary-300/50 rounded-full; }

/* Side nav arrows */
.flashcard-nav-arrow {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 44px;
  height: 44px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--color-card);
  border: 1px solid var(--color-border);
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 10;
  color: var(--color-muted-foreground);
}
.flashcard-nav-arrow:hover:not(:disabled) {
  background: var(--color-primary-50);
  border-color: var(--color-primary-300);
  color: var(--color-primary-600);
  box-shadow: 0 4px 16px rgba(0,0,0,0.12);
}
.dark .flashcard-nav-arrow:hover:not(:disabled) {
  background: var(--color-primary-900);
  border-color: var(--color-primary-700);
  color: var(--color-primary-400);
}
.flashcard-nav-arrow:disabled {
  opacity: 0.3;
  cursor: default;
}
.flashcard-nav-arrow.left { left: -56px; }
.flashcard-nav-arrow.right { right: -56px; }
@media (max-width: 768px) {
  .flashcard-nav-arrow.left { left: -8px; }
  .flashcard-nav-arrow.right { right: -8px; }
  .flashcard-nav-arrow {
    width: 36px;
    height: 36px;
    background: var(--color-card) / 0.9;
    backdrop-filter: blur(4px);
  }
}

/* ─── Analysis page sections ─── */
.analysis-item {
  border-left: 3px solid var(--item-color, var(--color-primary-400));
  padding: 12px 16px;
  border-radius: 0 10px 10px 0;
  background: var(--color-muted);
  transition: all 0.2s ease;
}
.analysis-item:hover {
  transform: translateX(3px);
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}
.analysis-card-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
}
.analysis-card-header svg {
  flex-shrink: 0;
}
.analysis-highlight-card {
  position: relative;
  overflow: hidden;
}
.analysis-highlight-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, #38bdf8, #818cf8, #c084fc, #f472b6);
  border-radius: 999px 999px 0 0;
}

/* ─── Sentence analysis component chips ─── */
.component-subject { --comp-accent: #3b82f6; --comp-bg: #eff6ff; --comp-bg-dark: rgba(59,130,246,0.15); --comp-text: #1e40af; --comp-text-dark: #93c5fd; }
.component-predicate { --comp-accent: #ef4444; --comp-bg: #fef2f2; --comp-bg-dark: rgba(239,68,68,0.15); --comp-text: #991b1b; --comp-text-dark: #fca5a5; }
.component-object { --comp-accent: #10b981; --comp-bg: #ecfdf5; --comp-bg-dark: rgba(16,185,129,0.15); --comp-text: #065f46; --comp-text-dark: #6ee7b7; }
.component-attribute { --comp-accent: #f59e0b; --comp-bg: #fffbeb; --comp-bg-dark: rgba(245,158,11,0.15); --comp-text: #92400e; --comp-text-dark: #fcd34d; }
.component-adverbial { --comp-accent: #8b5cf6; --comp-bg: #f5f3ff; --comp-bg-dark: rgba(139,92,246,0.15); --comp-text: #5b21b6; --comp-text-dark: #c4b5fd; }
.component-complement { --comp-accent: #ec4899; --comp-bg: #fdf2f8; --comp-bg-dark: rgba(236,72,153,0.15); --comp-text: #9d174d; --comp-text-dark: #f9a8d4; }
.component-appositive { --comp-accent: #6366f1; --comp-bg: #eef2ff; --comp-bg-dark: rgba(99,102,241,0.15); --comp-text: #3730a3; --comp-text-dark: #a5b4fc; }

.component-chip {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 2px;
  padding: 8px 14px;
  border-radius: 10px;
  border-left: 3.5px solid var(--comp-accent);
  background: var(--comp-bg);
  color: var(--comp-text);
  cursor: pointer;
  position: relative;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}
.dark .component-chip {
  background: var(--comp-bg-dark);
  color: var(--comp-text-dark);
}
.component-chip:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.08), 0 0 0 1px var(--comp-accent, transparent) / 0.15;
}
.component-chip-active {
  box-shadow: 0 0 0 2px var(--comp-accent), 0 4px 16px rgba(0,0,0,0.1);
  transform: translateY(-2px);
}
.component-chip-type {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.05em;
  opacity: 0.7;
}
.component-chip-text {
  font-family: 'Merriweather', serif;
  font-size: 14px;
  line-height: 1.4;
}

/* Detail panel slide-in */
@keyframes detailSlideIn {
  from { opacity: 0; transform: translateY(-8px); max-height: 0; }
  to { opacity: 1; transform: translateY(0); max-height: 200px; }
}
.component-detail-panel {
  animation: detailSlideIn 0.3s ease-out both;
  border-top: 3px solid var(--comp-accent);
  border-radius: 0 0 12px 12px;
  overflow: hidden;
}

/* Legend dot */
.legend-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}

/* ─── Quiz ─── */
.quiz-option {
  @apply transition-all duration-200;
}
.quiz-option:not(.correct):not(.incorrect):hover {
  @apply border-primary-300 bg-primary-50 dark:bg-primary-900/20;
}
.quiz-option.correct {
  @apply border-green-500 bg-green-50 dark:bg-green-900/30 shadow-sm;
}
.quiz-option.incorrect {
  @apply border-red-500 bg-red-50 dark:bg-red-900/30 shadow-sm;
}

/* ─── Vocabulary highlight ─── */
.highlighted-word {
  @apply bg-yellow-100 dark:bg-yellow-900/40 px-0.5 rounded cursor-pointer relative
         transition-colors duration-200 hover:bg-yellow-200 dark:hover:bg-yellow-800/50;
}

/* ─── Toast ─── */
@keyframes toastIn {
  from { transform: translateY(100%); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
@keyframes toastOut {
  from { transform: translateY(0); opacity: 1; }
  to { transform: translateY(100%); opacity: 0; }
}
.toast-enter { animation: toastIn 0.3s ease-out both; }
.toast-exit { animation: toastOut 0.25s ease-in both; }

/* ─── Modal backdrop ─── */
@keyframes backdropIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes modalIn {
  from { opacity: 0; transform: scale(0.95) translateY(10px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}
.modal-backdrop { animation: backdropIn 0.2s ease-out both; }
.modal-content { animation: modalIn 0.3s ease-out both; }

/* ─── Scrollbar ─── */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { @apply bg-border rounded-full; }
::-webkit-scrollbar-thumb:hover { @apply bg-muted-foreground/50; }
